@namespace DamageChecker.Components

<div class="add-buffs-menu" style=@addBuffHideStyle>
    <div class="add-buffs-header">
        <h1>ADD BUFFS</h1>
        <div class="search-area">
            <button class="search-button">
                <img id="search-icon" src="css/icons/search.svg" />
            </button>
            <input class="search-text-field" @bind-value=@query placeholder="SEARCH BUFFS..." />
        </div>
        <button class="apply-button" @onclick="OnApplyCallback">APPLY</button>
    </div>
    <div class="add-buffs-main">
        @foreach(BuffSelector selector in buffSelectors)
        {
            <div class="buff_selector">
                <h2 @onclick="()=>HideBuffList(selector)">@selector.Header</h2>
                <div class="buffs-list" style="@selector.Style">
                    @foreach(IStackable buff in selector.Buffs)
                    {
                        <div class=@(Buffs.HaveBuff(buff)? "buff-container-selected" :"buff-container") 
                        @onclick="()=>ClickBuff(buff)" 
                        @onmousemove=@((e)=>OnPerkOver(e,buff)) 
                        @onmouseout=@OnHidePerkSummary>
                            <div class="buff_icon">
                                <img src=@($"css/icons/perks/{buff.Name}.png")>
                            </div>
                            @(buff!=null? buff.Name.ToUpper() : "")
                        </div>
                    }
                </div>
            </div>
        }
    </div>

</div>
    

@code {
    private void ShowXandY(MouseEventArgs e){
        Console.WriteLine("y: "+e.PageY +" x: "+ e.PageX);
    }

    private void OnPerkOver(MouseEventArgs e,IStackable buff)
    {
        var args=new ShowPerkSummaryArgs()
        {
            PageX=e.PageX,
            PageY=e.PageY,
            Buff=buff
        };
        OnShowPerkSummary.InvokeAsync(args);
    }

    [Parameter]
    public EventCallback OnHidePerkSummary { get; set; }

    [Parameter]
    public EventCallback<ShowPerkSummaryArgs> OnShowPerkSummary { get; set; }
}
